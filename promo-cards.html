<!doctype html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wave Net | Promo Cards Render</title>

    <!-- Igual que index.html -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/estilos.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Shippori+Antique+B1:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* Base de tu index */
        body { font-family: 'Shippori Antique B1', Arial, sans-serif; background:#fff; }
        .bg-azul { background-color: #17215c !important; color: #fff; }
        .text-verde { color: #19e083; }
        .text-azul { color: #396bea; }
        .btn-wisp { background: #396bea; color: #fff; border-radius: 1.5rem; font-weight: 600; }
        .btn-wisp:hover { background: #17215c; color: #fff; }
        .card-paquete { border-radius: 1.2rem; box-shadow: 0 4px 16px #17215c10; }

        /* Solo para promos */
        .strike { text-decoration: line-through; text-decoration-thickness: 2px; opacity: .75; }
        .promo-chip {
            display:inline-block; padding:.25rem .6rem; border-radius:999px;
            font-weight:700; letter-spacing:.04em; font-size:.75rem;
            background: rgba(25,224,131,.12);
            border: 1px solid rgba(25,224,131,.35);
            color:#19e083;
        }
        .render-wrap { padding: 24px; }
        .render-grid { display:flex; flex-wrap:wrap; gap:18px; justify-content:center; }
        .render-card { width: 540px; } /* “catálogo WhatsApp” recomendado */
    </style>
</head>

<body>
<main class="render-wrap">
    <div class="text-center mb-3">
        <img src="assets/wn_c2.png" alt="Wave Net logo" style="max-width:120px;" class="mb-2">
        <div class="text-muted small">Render de promociones (exportable a PNG)</div>
    </div>

    <div id="cards" class="render-grid"></div>
</main>

<script>
    // Puedes dejarlo como planes.json, o apuntar a un JSON de promos separado.
    const JSON_URL = 'modulos/planes.json';

    // Helpers
    const mxn = (n) => {
        // si viene como string, intenta parsear
        const num = typeof n === 'string' ? Number(String(n).replace(/[^0-9.]/g,'')) : n;
        if (!Number.isFinite(num)) return n;
        return num.toLocaleString('es-MX');
    };

    async function cargarPromoCards(url, idDestino) {
        const resp = await fetch(url, { cache: 'no-store' });
        const planes = await resp.json();

        let html = '';

        planes.forEach(plan => {
            // Estos campos son los “opcionales” para promo.
            // Puedes nombrarlos como quieras; yo sugiero:
            // precio_promo, velocidad_promo, nombre_promo (opcional)
            const hasPromo = plan.precio_promo != null && plan.velocidad_promo != null;

            const nombreMostrado = plan.nombre_promo ?? plan.nombre;

            const precioBlock = hasPromo ? `
          <div class="mb-2">
            <span class="promo-chip">PROMO</span>
          </div>

          <div class="mb-1">
            <span class="h6 mb-0 strike">$${mxn(plan.precio)}</span>
            <span class="small text-muted"> MXN / mes</span>
          </div>

          <div class="display-6 fw-bold mb-2">
            $${mxn(plan.precio_promo)} <span class="fs-6 fw-normal">MXN / mes</span>
          </div>
        ` : `
          <div class="display-6 fw-bold mb-2">
            $${mxn(plan.precio)} <span class="fs-6 fw-normal">MXN / mes</span>
          </div>
        `;

            const velocidadBlock = hasPromo ? `
          <p class="mb-2">
            <span class="strike">${plan.velocidad}</span><br>
            <span class="fw-bold">${plan.velocidad_promo}</span><br>
            <span class="small">${plan.descripcion ?? ''}</span>
          </p>
        ` : `
          <p class="mb-2">${plan.velocidad}<br><span class="small">${plan.descripcion ?? ''}</span></p>
        `;

            html += `
          <div class="render-card" data-card="${plan.nombre}">
            <div class="card card-paquete h-100 shadow-sm border-0">
              <div class="card-body text-center">
                <div class="mb-2">
                  <i class="bi bi-${plan.icon} fs-1 text-azul"></i>
                </div>

                <h4 class="fw-bold mb-2">${nombreMostrado}</h4>

                ${precioBlock}
                ${velocidadBlock}


                <!-- Para render a imagen no necesitas botón, pero lo dejo por consistencia -->
                <div class="small text-muted">Válido en Condominio Vancouver · Sujeto a factibilidad</div>
              </div>
            </div>
          </div>
        `;
        });

        document.getElementById(idDestino).innerHTML = html;
    }

    cargarPromoCards(JSON_URL, 'cards');
</script>
</body>
</html>